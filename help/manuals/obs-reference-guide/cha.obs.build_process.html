<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Build Process | Reference Guide</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DAPS 3.0.0 (https://opensuse.github.io/daps) using SUSE XSL Stylesheets 2.0.13 (based on DocBook XSL Stylesheets snapshot) - chunked" /><meta name="book-title" content="Reference Guide" /><meta name="chapter-title" content="Chapter 3. Build Process" /><link rel="home" href="index.html" title="OBS Documentation" /><link rel="up" href="book.obs-reference-guide.html" title="Reference Guide" /><link rel="prev" href="cha.obs.concepts.html" title="Chapter 2. OBS Concepts" /><link rel="next" href="cha.obs.source_management.html" title="Chapter 4. Source Management" /><script type="text/javascript">

var protocol = window.location.protocol.toLowerCase();
if ( protocol != 'file:' ) {
  var agent = navigator.userAgent.toLowerCase();
  var wanted = ( protocol == 'https:') ? 'https' : 'http';
  var file = 'fonts.css';
  document.write('<link rel="stylesheet" type="text/css" href="' + wanted + '://static.opensuse.org/fonts/'+ file +'"></link>');
}
else {
   document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="http://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="offline js-off"><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="Reference Guide"><span class="book-icon">Reference Guide</span></a><span> › </span><a class="crumb" href="cha.obs.build_process.html">Build Process</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.htmlindex.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Reference Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="bk04pr01.html"><span class="number"> </span><span class="name">About this Guide</span></a></li><li class="inactive"><a href="cha.obs.architecture.html"><span class="number">1 </span><span class="name">OBS Architecture</span></a></li><li class="inactive"><a href="cha.obs.concepts.html"><span class="number">2 </span><span class="name">OBS Concepts</span></a></li><li class="inactive"><a href="cha.obs.build_process.html"><span class="number">3 </span><span class="name">Build Process</span></a></li><li class="inactive"><a href="cha.obs.source_management.html"><span class="number">4 </span><span class="name">Source Management</span></a></li><li class="inactive"><a href="cha.obs.request_and_review_ystem.html"><span class="number">5 </span><span class="name">Request And Review System</span></a></li><li class="inactive"><a href="cha.obs.image_templates.html"><span class="number">6 </span><span class="name">Image Templates</span></a></li><li class="inactive"><a href="cha.obs.multibuild.html"><span class="number">7 </span><span class="name">Multiple Build Description File Handling</span></a></li><li class="inactive"><a href="cha.obs.maintenance_setup.html"><span class="number">8 </span><span class="name">Maintenance Support</span></a></li><li class="inactive"><a href="cha.obs.binary_tracking.html"><span class="number">9 </span><span class="name">Binary Package Tracking</span></a></li><li class="inactive"><a href="cha.obs.admin.html"><span class="number">10 </span><span class="name">Administration</span></a></li><li class="inactive"><a href="cha.obs.build_scheduling_and_dispatching.html"><span class="number">11 </span><span class="name">Scheduling and Dispatching</span></a></li><li class="inactive"><a href="cha.obs.build_job_constraints.html"><span class="number">12 </span><span class="name">Build Job Constraints</span></a></li><li class="inactive"><a href="cha.obs.build_preinstall.html"><span class="number">13 </span><span class="name">Building Preinstall Images</span></a></li><li class="inactive"><a href="cha.obs.authorization.token.html"><span class="number">14 </span><span class="name">Authorization</span></a></li><li class="inactive"><a href="cha.obs.qa_hooks.html"><span class="number">15 </span><span class="name">Quality Assurance(QA) Hooks</span></a></li><li class="inactive"><a href="cha.obs.factory.html"><span class="number">16 </span><span class="name">openSUSE Factory</span></a></li><li class="inactive"><a href="obs.glossary.html"><span class="number"> </span><span class="name">Glossary</span></a></li><li class="inactive"><a href="bk04apa.html"><span class="number">A </span><span class="name">GNU Licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 2. OBS Concepts" href="cha.obs.concepts.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 4. Source Management" href="cha.obs.source_management.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="Reference Guide"><span class="book-icon">Reference Guide</span></a><span> › </span><a class="crumb" href="cha.obs.build_process.html">Build Process</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 2. OBS Concepts" href="cha.obs.concepts.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 4. Source Management" href="cha.obs.source_management.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class=""><div class="documentation"><div class="chapter " id="cha.obs.build_process"><div class="titlepage"><div><div><h1 class="title"><span class="number">3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Build Process</span> </h1></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha.obs.build_process.html#id-1.7.7.3"><span class="number">3.1 </span><span class="name">Phases of a Build Process</span></a></span></dt><dt><span class="sect1"><a href="cha.obs.build_process.html#id-1.7.7.4"><span class="number">3.2 </span><span class="name">Identify a build</span></a></span></dt></dl></div></div>
 
 <p>
  Each package build is created in a fresh environment. This is done to
  ensure that all dependencies are available and that every later build
  produces identical results.
 </p>
 
 <div class="sect1 " id="id-1.7.7.3"><div class="titlepage"><div><div><h2 class="title" id="id-1.7.7.3"><span class="number">3.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Phases of a Build Process</span> <a title="Permalink" class="permalink" href="cha.obs.build_process.html#id-1.7.7.3">#</a></h2></div></div></div>
  
  <p>
   All sources and binaries which are hosted inside Open Build Service are organized in
   projects. Projects host sources inside of OBS packages. The sources are
   build according to the repository configuration inside of the project.
  </p>
  <div class="sect2 " id="id-1.7.7.3.3"><div class="titlepage"><div><div><h3 class="title" id="id-1.7.7.3.3"><span class="number">3.1.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Preinstall Phase</span> <a title="Permalink" class="permalink" href="cha.obs.build_process.html#id-1.7.7.3.3">#</a></h3></div></div></div>
   
   
   <p>
    This phase depends on the type of the buildroot (building
    environment). OBS supports three different types of buildroots:
   </p>
    <div class="itemizedlist "><ul class="itemizedlist"><li class="listitem ">
      <p>
       chroot
      </p>
     </li><li class="listitem ">
      <p>
       Xen
      </p>
     </li><li class="listitem ">
      <p>
       KVM
      </p>
     </li></ul></div> 
    <p>
    In the preinstall phase, the OBS Worker creates a small
    base system (chroot or VM Image) with manually extracted packages (file
    system, coreutils, binutils, rpm/debutils, etc.), copies all necessary
    build requirements into the base system. </p>
  </div>
  <div class="sect2 " id="id-1.7.7.3.4"><div class="titlepage"><div><div><h3 class="title" id="id-1.7.7.3.4"><span class="number">3.1.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Install Phase</span> <a title="Permalink" class="permalink" href="cha.obs.build_process.html#id-1.7.7.3.4">#</a></h3></div></div></div>
   
   <p>
    Depending on the chosen build root, the worker starts a Xen or KVM
    virtual machine or enters the build root. If this was successful, the
    install phase reinstalls all base packages from above and additionally all
    packages you have defined in your build recipe. After this phase the
    environment is ready to process the build recipe.
   </p>
  </div>
  <div class="sect2 " id="id-1.7.7.3.5"><div class="titlepage"><div><div><h3 class="title" id="id-1.7.7.3.5"><span class="number">3.1.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Package Build</span> <a title="Permalink" class="permalink" href="cha.obs.build_process.html#id-1.7.7.3.5">#</a></h3></div></div></div>
   
   
   <p>
    Depending on the type of package, the buildroot executes different build
    commands:
   </p>
   <div class="itemizedlist "><ul class="itemizedlist"><li class="listitem ">
     <p>
      RPM-based distributions: <code class="command">rpmbuild</code>
     </p>
    </li><li class="listitem ">
     <p>
      Debian-based distributions: <code class="command">dpkg-buildpackage</code>
     </p>
    </li><li class="listitem ">
     <p>
      Arch Linux: <code class="command">pacman</code>.
     </p>
    </li></ul></div>
   <p>
    How the build continues depends on the quality and the type of your build
    recipe. In most cases, the source code will be compiled now and then be
    packed into the chosen package format.
   </p>
   <p>
    To improve package quality, on RPM-based distributions there are
    additional security checks and a linter called <code class="command">rpmlint</code>.
   </p>
  </div>
  <div class="sect2 " id="id-1.7.7.3.6"><div class="titlepage"><div><div><h3 class="title" id="id-1.7.7.3.6"><span class="number">3.1.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">After the Build</span> <a title="Permalink" class="permalink" href="cha.obs.build_process.html#id-1.7.7.3.6">#</a></h3></div></div></div>
   
   <p>
    The generated packages are taken from the worker, are signed by the
    OBS signer and are published to the Repository.
   </p>
   
  </div>
 </div>
 
 
 <div class="sect1 " id="id-1.7.7.4"><div class="titlepage"><div><div><h2 class="title" id="id-1.7.7.4"><span class="number">3.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Identify a build</span> <a title="Permalink" class="permalink" href="cha.obs.build_process.html#id-1.7.7.4">#</a></h2></div></div></div>
  
  <p>
    OBS is usally tagging each build with an identifier. This can be used to find the building 
    OBS instance, the project, repository and exact source for a binary. This information is
    stored in some variable called DISTURL and is specified as 
     <code class="command">obs://$OBS_INSTANCE/$PROJECT/$REPOSITORY/$SOURCE_REVISION-$PACKAGE(:$FLAVOR)</code>
    . Note that the last $:FLAVOR part is optional and exists only when the package was build using the multibuild feature.

    The source specified via the DISTURL can be accessed by pasting the URL into the search interface
    of the OBS web interface. Or use the command line tool to check it out:
    </p><div class="verbatim-wrap"><pre class="screen">     <code class="command"># osc checkout $DISTURL</code></pre></div><p>
    You need to go to the right OBS instance as this is not handled automatically yet.
  </p>
  <div class="sect2 " id="id-1.7.7.4.3"><div class="titlepage"><div><div><h3 class="title" id="id-1.7.7.4.3"><span class="number">3.2.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Read DISTURL from a rpm</span> <a title="Permalink" class="permalink" href="cha.obs.build_process.html#id-1.7.7.4.3">#</a></h3></div></div></div>
   
   <p>
    Rpm binaries contain the DISTURL as tag. It can be read from the rpm database for installed rpms and
    also from the rpm binaries itself.
    </p><div class="verbatim-wrap"><pre class="screen">     <code class="command"># rpm -q --qf '%{DISTRL}\n' $rpm</code></pre></div><p>
   </p>
  </div>
  <div class="sect2 " id="id-1.7.7.4.4"><div class="titlepage"><div><div><h3 class="title" id="id-1.7.7.4.4"><span class="number">3.2.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Read DISTURL from a container</span> <a title="Permalink" class="permalink" href="cha.obs.build_process.html#id-1.7.7.4.4">#</a></h3></div></div></div>
   
   <p>
    Containers store the DISTURL as label. You will see only the DISTURL from the highest layer via
    </p><div class="verbatim-wrap"><pre class="screen">     <code class="command"># docker inspect --format '{{.Config.Labels}}' $image_id</code></pre></div><p>
    The disturl is always set via the key 'org.openbuildservice.disturl'.
   </p>
  </div>
 </div>
</div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="cha.obs.source_management.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 4 </span>Source Management</span></a><a class="nav-link" href="cha.obs.concepts.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 2 </span>OBS Concepts</span></a></div><div id="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span id="_share-fb" class="bottom-button">Facebook</span><span class="spacer"> • </span><span id="_share-gp" class="bottom-button">Google+</span><span class="spacer"> • </span><span id="_share-tw" class="bottom-button">Twitter</span><span class="spacer"> • </span><span id="_share-mail" class="bottom-button">E-Mail</span></span></div><div class="print"><span id="_print-button" class="bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2019 
        SUSE</p><ul><li><a href="http://www.suse.com/company/careers/" target="_top">Careers</a></li><li><a href="http://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="http://www.suse.com/company/" target="_top">About</a></li><li><a href="http://www.suse.com/ContactsOffices/contacts_offices.jsp" target="_top">Contact Us</a></li></ul></div></div></body></html>