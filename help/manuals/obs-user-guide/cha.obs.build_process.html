<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Build Process | User Guide</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DAPS 3.2.0 (https://opensuse.github.io/daps) using SUSE XSL Stylesheets 2.81.0 (based on DocBook XSL Stylesheets snapshot) - chunked" /><meta name="book-title" content="User Guide" /><meta name="chapter-title" content="Chapter 22. Build Process" /><meta name="description" content="The build process creates new binaries from sources, binaries, and config. This process may run on the OBS server side or on a local workstation. Each package build is created in a fresh environment. This is done to ensure that the environment is reproducible." /><link rel="home" href="index.html" title="OBS Documentation" /><link rel="up" href="par.reference.html" title="Part VI. Reference" /><link rel="prev" href="cha.obs.concepts.html" title="Chapter 21. OBS Concepts" /><link rel="next" href="cha.obs.build_containers.html" title="Chapter 23. Build Containers" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://static.opensuse.org/fonts/fonts.css"></link>');
}
else {
  document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="https://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="offline js-off"><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="User Guide"><span class="book-icon">User Guide</span></a><span> › </span><a class="crumb" href="par.reference.html">Reference</a><span> › </span><a class="crumb" href="cha.obs.build_process.html">Build Process</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>User Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="bk02pr01.html"><span class="number"> </span><span class="name">About this Guide</span></a></li><li class="inactive"><a href="par.first_steps.html"><span class="number">I </span><span class="name">First Steps</span></a><ol><li class="inactive"><a href="art.obs.bg.html"><span class="number">1 </span><span class="name">Beginnerʼs Guide</span></a></li></ol></li><li class="inactive"><a href="par.concepts.html"><span class="number">II </span><span class="name">Concepts</span></a><ol><li class="inactive"><a href="cha.obs.package_formats.html"><span class="number">2 </span><span class="name">Supported Build Recipes and Package Formats</span></a></li></ol></li><li class="inactive"><a href="bk02pt03.html"><span class="number">III </span><span class="name">Setup</span></a><ol><li class="inactive"><a href="cha.obs.osc.html"><span class="number">3 </span><span class="name">osc, the Command Line Tool</span></a></li><li class="inactive"><a href="cha.obs.prjconfig.html"><span class="number">4 </span><span class="name">Project Configuration</span></a></li></ol></li><li class="inactive"><a href="par.working.html"><span class="number">IV </span><span class="name">Usage</span></a><ol><li class="inactive"><a href="cha.obs.basicworkflow.html"><span class="number">5 </span><span class="name">Basic OBS Workflow</span></a></li><li class="inactive"><a href="cha.obs.building.html"><span class="number">6 </span><span class="name">Local Building</span></a></li><li class="inactive"><a href="cha.obs.source_service.html"><span class="number">7 </span><span class="name">Using Source Services</span></a></li><li class="inactive"><a href="cha.obs.scm_ci_workflow_integration.html"><span class="number">8 </span><span class="name">SCM/CI Workflow Integration [Beta Feature]</span></a></li><li class="inactive"><a href="cha.obs.stagingworkflow.html"><span class="number">9 </span><span class="name">Staging Workflow</span></a></li><li class="inactive"><a href="cha.obs.notifications.html"><span class="number">10 </span><span class="name">Notifications</span></a></li></ol></li><li class="inactive"><a href="par.best_practices.html"><span class="number">V </span><span class="name">Best Practices</span></a><ol><li class="inactive"><a href="cha.obs.best-practices.webuiusage.html"><span class="number">11 </span><span class="name">Using the OBS Web UI</span></a></li><li class="inactive"><a href="cha.obs.best-practices.basics.html"><span class="number">12 </span><span class="name">Basic Concepts and Work Styles</span></a></li><li class="inactive"><a href="cha.obs.best-practices.scm_integration.html"><span class="number">13 </span><span class="name">How to integrate external SCM sources</span></a></li><li class="inactive"><a href="cha.obs.best-practices.upstream.html"><span class="number">14 </span><span class="name">Publishing Upstream Binaries</span></a></li><li class="inactive"><a href="cha.obs.best-practices.bootstrapping.html"><span class="number">15 </span><span class="name">Bootstrapping</span></a></li><li class="inactive"><a href="cha.obs.best-practices.oscexamples.html"><span class="number">16 </span><span class="name"><code class="command">osc</code> Example Commands</span></a></li><li class="inactive"><a href="cha.obs.best-practices.advanced.html"><span class="number">17 </span><span class="name">Advanced Project Setups</span></a></li><li class="inactive"><a href="cha.obs.best-practices.kmp.html"><span class="number">18 </span><span class="name">Building Kernel Modules</span></a></li><li class="inactive"><a href="cha.obs.best-practices.howto.html"><span class="number">19 </span><span class="name">Common Questions and Solutions</span></a></li></ol></li><li class="inactive"><a href="par.reference.html"><span class="number">VI </span><span class="name">Reference</span></a><ol><li class="inactive"><a href="cha.obs.architecture.html"><span class="number">20 </span><span class="name">OBS Architecture</span></a></li><li class="inactive"><a href="cha.obs.concepts.html"><span class="number">21 </span><span class="name">OBS Concepts</span></a></li><li class="inactive"><a href="cha.obs.build_process.html"><span class="number">22 </span><span class="name">Build Process</span></a></li><li class="inactive"><a href="cha.obs.build_containers.html"><span class="number">23 </span><span class="name">Build Containers</span></a></li><li class="inactive"><a href="cha.obs.source_management.html"><span class="number">24 </span><span class="name">Source Management</span></a></li><li class="inactive"><a href="cha.obs.supported_formats.html"><span class="number">25 </span><span class="name">Supported Formats</span></a></li><li class="inactive"><a href="cha.obs.request_and_review_system.html"><span class="number">26 </span><span class="name">Request And Review System</span></a></li><li class="inactive"><a href="cha.obs.image_templates.html"><span class="number">27 </span><span class="name">Image Templates</span></a></li><li class="inactive"><a href="cha.obs.multibuild.html"><span class="number">28 </span><span class="name">Multiple Build Description File Handling</span></a></li><li class="inactive"><a href="cha.obs.maintenance_setup.html"><span class="number">29 </span><span class="name">Maintenance Support</span></a></li><li class="inactive"><a href="cha.obs.binary_tracking.html"><span class="number">30 </span><span class="name">Binary Package Tracking</span></a></li><li class="inactive"><a href="cha.obs.admin.html"><span class="number">31 </span><span class="name">Administration</span></a></li><li class="inactive"><a href="cha.obs.build_scheduling_and_dispatching.html"><span class="number">32 </span><span class="name">Scheduling and Dispatching</span></a></li><li class="inactive"><a href="cha.obs.build_job_constraints.html"><span class="number">33 </span><span class="name">Build Job Constraints</span></a></li><li class="inactive"><a href="cha.obs.build_preinstall.html"><span class="number">34 </span><span class="name">Building Preinstall Images</span></a></li><li class="inactive"><a href="cha.obs.authorization.token.html"><span class="number">35 </span><span class="name">Authorization</span></a></li><li class="inactive"><a href="cha.obs.qa_hooks.html"><span class="number">36 </span><span class="name">Quality Assurance(QA) Hooks</span></a></li><li class="inactive"><a href="cha.obs.factory.html"><span class="number">37 </span><span class="name">openSUSE Factory</span></a></li></ol></li><li class="inactive"><a href="obs.glossary.html"><span class="number"> </span><span class="name">Glossary</span></a></li><li class="inactive"><a href="bk02apa.html"><span class="number">A </span><span class="name">GNU Licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 21. OBS Concepts" href="cha.obs.concepts.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 23. Build Containers" href="cha.obs.build_containers.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="User Guide"><span class="book-icon">User Guide</span></a><span> › </span><a class="crumb" href="par.reference.html">Reference</a><span> › </span><a class="crumb" href="cha.obs.build_process.html">Build Process</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 21. OBS Concepts" href="cha.obs.concepts.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 23. Build Containers" href="cha.obs.build_containers.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class=""><div class="documentation"><div class="chapter " id="cha.obs.build_process"><div class="titlepage"><div><div><h2 class="title"><span class="number">22 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Build Process</span> <a title="Permalink" class="permalink" href="cha.obs.build_process.html#">#</a></h2></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha.obs.build_process.html#id-1.5.10.4.3"><span class="number">22.1 </span><span class="name">Phases of a Build Process</span></a></span></dt><dt><span class="sect1"><a href="cha.obs.build_process.html#id-1.5.10.4.4"><span class="number">22.2 </span><span class="name">Identify a build</span></a></span></dt></dl></div></div>
 
 <p>
  The build process creates new binaries from sources, binaries, and config.
  This process may run on the OBS server side or on a
  local workstation. Each package build is created in a fresh environment. This is done to
  ensure that the environment is reproducible.
 </p>
 
 <div class="sect1 " id="id-1.5.10.4.3"><div class="titlepage"><div><div><h2 class="title"><span class="number">22.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Phases of a Build Process</span> <a title="Permalink" class="permalink" href="cha.obs.build_process.html#id-1.5.10.4.3">#</a></h2></div></div></div>
  
  <p>
   All sources and binaries which are hosted inside Open Build Service are organized in
   projects. Projects host sources inside of OBS packages. The sources are
   built according to the repository configuration inside of the project.
  </p>
  <div class="sect2 " id="id-1.5.10.4.3.3"><div class="titlepage"><div><div><h3 class="title"><span class="number">22.1.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Preinstall Phase</span> <a title="Permalink" class="permalink" href="cha.obs.build_process.html#id-1.5.10.4.3.3">#</a></h3></div></div></div>
   
   
   <p>
    This phase depends on the type of the buildroot (building
    environment). OBS supports multiple types of build environments, for example:
   </p>
    <div class="itemizedlist "><ul class="itemizedlist"><li class="listitem ">
      <p>
       chroot
      </p>
     </li><li class="listitem ">
      <p>
       Xen
      </p>
     </li><li class="listitem ">
      <p>
       KVM
      </p>
     </li><li class="listitem ">
      <p>
       Qemu
      </p>
     </li></ul></div>
    <p>
    In the preinstall phase, the OBS Worker creates a small
    base system from the packages declared to be preinstalled (file
    system, coreutils, binutils, rpm/debutils, etc.). The tools installed in this
    phase must only provide the minimum functionality necessary to allow installing
    further packages. In addition it copies all necessary build requirements and
    the source into the base system. </p>
  </div>
  <div class="sect2 " id="id-1.5.10.4.3.4"><div class="titlepage"><div><div><h3 class="title"><span class="number">22.1.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Install Phase</span> <a title="Permalink" class="permalink" href="cha.obs.build_process.html#id-1.5.10.4.3.4">#</a></h3></div></div></div>
   
   <p>
    Depending on the chosen build environment, the worker may start a
    virtual machine, an emulator or just enter the build root. If this was successful, the
    install phase reinstalls all base packages from above and additionally all
    packages you have defined in your build recipe plus dependencies. After this phase the
    environment is ready to process the build recipe.
   </p>
  </div>
  <div class="sect2 " id="id-1.5.10.4.3.5"><div class="titlepage"><div><div><h3 class="title"><span class="number">22.1.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Package Build</span> <a title="Permalink" class="permalink" href="cha.obs.build_process.html#id-1.5.10.4.3.5">#</a></h3></div></div></div>
   
   <p>
    Depending on the type of package, the build environment executes different build
    commands, for example:
   </p>
   <div class="itemizedlist "><ul class="itemizedlist"><li class="listitem ">
     <p>
      RPM-based distributions: <code class="command">rpmbuild</code>
     </p>
    </li><li class="listitem ">
     <p>
      Debian-based distributions: <code class="command">dpkg-buildpackage</code>
     </p>
    </li><li class="listitem ">
     <p>
      Arch Linux: <code class="command">pacman</code>
     </p>
    </li><li class="listitem ">
     <p>
      Kiwi image: <code class="command">kiwi</code>.
     </p>
    </li></ul></div>
   <p>
    How the build continues depends on the quality and the type of your build
    recipe. In most cases, the source code will be compiled now and then be
    packed into the chosen package format.
   </p>
   <p>
    To improve package quality, on RPM-based distributions there are
    additional checks provided via packages. A common toolchain for handling
    checks is for example <code class="command">rpmlint</code>.
   </p>
  </div>
  <div class="sect2 " id="id-1.5.10.4.3.6"><div class="titlepage"><div><div><h3 class="title"><span class="number">22.1.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">After the Build</span> <a title="Permalink" class="permalink" href="cha.obs.build_process.html#id-1.5.10.4.3.6">#</a></h3></div></div></div>
   
   <p>
     The generated packages are extracted from the build environment and transferred
     back to the server by the worker. The build result might be postprocessed by
     followup build jobs. Afterwards the resulting files may get signed.
   </p>
  </div>
 </div>
 
 
 <div class="sect1 " id="id-1.5.10.4.4"><div class="titlepage"><div><div><h2 class="title"><span class="number">22.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Identify a build</span> <a title="Permalink" class="permalink" href="cha.obs.build_process.html#id-1.5.10.4.4">#</a></h2></div></div></div>
  
  <p>
    OBS is usually tagging each build with an identifier. This can be used to find the building
    OBS instance, the project, repository and exact source for a binary. This information is
    stored in some variable called DISTURL and is specified as
     <code class="command">obs://$OBS_INSTANCE/$PROJECT/$REPOSITORY/$SOURCE_REVISION-$PACKAGE(:$FLAVOR)</code>.
    Note that the final segment, <code class="literal">:$FLAVOR</code>, is optional and exists only for packages built using the multibuild feature.

    The source specified via the DISTURL can be accessed by pasting the URL into the search interface
    of the OBS web interface. Or use the command line tool to check it out:
  </p>
  <div class="verbatim-wrap"><pre class="screen"><code class="command"># osc checkout $DISTURL</code></pre></div>
  <p>
    You need to go to the right OBS instance as this is not handled automatically yet.
  </p>
  <div class="sect2 " id="id-1.5.10.4.4.5"><div class="titlepage"><div><div><h3 class="title"><span class="number">22.2.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Read DISTURL from an RPM</span> <a title="Permalink" class="permalink" href="cha.obs.build_process.html#id-1.5.10.4.4.5">#</a></h3></div></div></div>
   
   <p>
    RPM binaries contain the DISTURL as tag. It can be read from the rpm database for installed RPMs and
    also from the rpm binaries itself.
   </p>
    <div class="verbatim-wrap"><pre class="screen"><code class="command"># rpm -q --qf '%{DISTRL}\n' $rpm</code></pre></div>
  </div>
  <div class="sect2 " id="id-1.5.10.4.4.6"><div class="titlepage"><div><div><h3 class="title"><span class="number">22.2.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Read DISTURL from a container</span> <a title="Permalink" class="permalink" href="cha.obs.build_process.html#id-1.5.10.4.4.6">#</a></h3></div></div></div>
   
   <p>
    Containers store the DISTURL as label. You will see only the DISTURL from the highest layer via
   </p>
    <div class="verbatim-wrap"><pre class="screen"><code class="command"># docker inspect --format '{{.Config.Labels}}' $image_id</code></pre></div>
    <p>
    The disturl is always set via the key 'org.openbuildservice.disturl'.
   </p>
  </div>
 </div>
</div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="cha.obs.build_containers.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 23 </span>Build Containers</span></a><a class="nav-link" href="cha.obs.concepts.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 21 </span>OBS Concepts</span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2021 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>